\chapter{Lagrange力学和量子力学的路径积分形式}

    \section{最小作用量原理与Lagrange力学}        

        在经典力学中, 除了可以用基于
         哈密顿量的Hamilton力学描述力学体系, 还可以使用Lagrange力学作为
         一种完全等效的描述手段. 在探索量子力学的其他的表示方法之前, 
         先回顾一下经典力学中除Hamilton力学之外其他的两种描述力学系统的手段:
          Lagrange力学, 或者Hamilton-Jacobi方程. 
        
        在本讲义的最开始，就已经给出了Hamilton力学中的Hamilton正则方程, 
        并且省略了推导过程. 这里将给出其推导.

        首先需要给出描述经典力学中最为重要的力学原理, \textbf{最小作用量原理}. 
        它完全概括了经典力学体系的运动规律.

        \begin{law}[最小作用量原理]
            力学体系有一个与其运动相关的物理量称为\textbf{作用量}$S$, 
            它是一个洛伦兹标量. 如果一个力学体系在给定时刻$t_1$和$t_2$分别由给定的
            广义坐标$q^{(1)}$与$q^{(2)}$描写, 则该力学系统的作用量$S$可以表达为
            联结这两个位型之间各种可能轨迹的\textbf{泛函}. 
            \begin{equation}
                S[\bm q(t)] = \int_{t_1}^{t_2} L( \bm q(t), \dot{\bm q}(t), t ) \dd t
            \end{equation}
            这里的函数$L(\bm q,\dot{\bm q},t)$称为系统的\textbf{拉格朗日量}, 该力学体系在时刻$t_1$和$t_2$之间联结广义坐标$\bm q^{(1)}$与$\bm q^{(2)}$的真实运动轨迹就是使作用量$S$的一阶变分$\delta S = 0$的轨迹\cite{刘川理力}.
        \end{law}
        这是一个原理, 这意味着它不是通过推到得出来的. 就如同电磁学中的麦克斯韦尔方程式, 
        统计热力学中的各态历经原理一样, 它们的正确性是由它们推论的正确性保证的. 

        接着来讨论有关与泛函和变分的问题. 泛函可以认为是一个函数空间到$\mathbb{R}$的映射
        , 它的自变量是一个函数
        \footnote{
            在这里我并不想给出泛函与泛函微分在数学上严格的定义, 
            读者可以自行寻找相关参考书籍.
            }. 
        假设系统真实运动轨迹是$\bm q_\mathrm{c}(t)$, 显然有
        $\bm q_\mathrm{c}(t_1) = \bm q^{(1)}$, $\bm q_\mathrm{c}(t_2) =\bm q^{(2)}$. 
        考虑一个对真实运动轨迹的一个微小偏离$\delta \bm q(t)$, 
        且在这里我们要求这个微小的偏离满足$\delta \bm q(t_1)=\delta \bm q(t_2)=0$. 
        这个对真实轨迹的微小偏离在数学上称为变分.
        最小作用量原理要求$\delta S = 0$, 那么首先根据定义写下$\delta S$: 
        \begin{equation}
            \delta S = \int_{t_1}^{t_2} L( \bm q_\mathrm{c} + \delta \bm q(t_1) , \dot{\bm q}_\mathrm{c} + \delta \dot{\bm q}(t_1), t ) \dd t - \int_{t_1}^{t_2} L( \bm q_\mathrm{c} , \dot{\bm q}_\mathrm{c}, t ) \dd t
        \end{equation}
        使得$\delta \bm q$为无穷小量, 则可以得到
        \footnote{
            这里使用了爱因斯坦求和规定, 即隐含一个对相同指标(这里是$i$)的求和号. 
            笔者认为这种表达比使用向量表示更不容易出错, 缺点在于指标太多的时候可能没法
            很好地把式子整理得很好看. (但以笔者的微レ存的数理基础, 用向量表示可能会
            推错式子)
            }
        \begin{equation}
            \delta S = \int_{t_1}^{t_2} \dd t \left( \frac{\partial L}{\partial q_i} \delta q_i + \frac{\partial L}{\partial \dot q_i} \delta \dot q_i \right)
        \end{equation}
        注意到, 通过分步积分:
        \begin{equation}
            \frac{\partial L}{\partial \dot q_i} \delta \dot q_i = \frac{\mathrm{d}}{\mathrm{d} t} \left( \frac{\partial L}{\partial \dot q_i} \delta q_i \right) - \left(\frac{\mathrm{d} }{\mathrm{d} t} \frac{\partial L}{\partial \dot q_i} \right) \delta q_i
        \end{equation}
        可以得到:
        \begin{equation}\label{eq:8-1-1}
            \delta S = \left. \frac{\partial L}{\partial \dot q_i} \delta q_i \right|_{t_1}^{t_2} + \int_{t_1}^{t_2} \dd t \left( \frac{\partial L}{\partial q_i} - \frac{\mathrm{d} }{\mathrm{d} t} \frac{\partial L}{\partial \dot q_i} \right) \delta q_i = 0
        \end{equation}
        在端点处我们要求过$\delta \bm q(t_1)=\delta \bm q(t_2)=0$, 
        所以上式中第一项为0. 由于第二项对于任意的$\delta q_i(t)$都必须成立, 
        而且各个$\delta q_i(t)$都是完全独立的变分, 所以唯一的可能就是上式中的括号等于0
        . 于是我们推出了在Lagrange力学中描述运动的方程, Euler-Lagrange方程
        \footnote{
            更广泛地讲, 这个方程给出了很大一类泛函极值问题的解, 其存在是变分原理保证的, 
            不受经典力学框架的限制. 
        }
        :
        \begin{equation}
            \frac{\partial L}{\partial q_i} - \frac{\mathrm{d} }{\mathrm{d} t} \frac{\partial L}{\partial \dot q_i} = 0
            \qquad i = 1,2,\cdots,f.
        \end{equation}
        其中$f$为系统的自由度. 

        拉格朗日量在Lagrange力学中处于中心地位, 它描述了体系全部的经典力学性质. 
        对于非相对论的力学体系, 拉格朗日量可以写为动能减去势能$L = K - V$. 
        在一些坐标系下动能可能有些非常繁杂的表达式, 而势能仅依赖于广义坐标与时间. 
        拉格朗日量的形式如下: 
        \begin{equation}
            L =  \frac{M_{ij}(\bm q)}{2} \dot q_i \dot q_j  - V(\bm q, t)
        \end{equation}
        并定义广义动量为: 
        \begin{equation}
            p_i =\frac{\partial L}{\partial \dot q_i} = M_{ij}(\bm q) \dot q_j
        \end{equation}

        \splitline

        考虑拉格朗日量对时间的全导数（即沿着某条经典运动路径的导数）:
        \begin{equation}
            \frac{\mathrm{d} L}{\mathrm{d} t} = \frac{\partial L}{\partial t} + p_i \ddot q_i + \dot p_i \dot q_i = \frac{\partial L}{\partial t} +  \frac{\mathrm{d} (p_i \dot q_i)}{\mathrm{d} t}
        \end{equation}
        如果拉格朗日量不显含时间, 那么定义系统的守恒量$E = p_i \dot q_i - L$是能量. 
        受到系统能量的启发, 对拉格朗日量进行勒让德变换
        \footnote{这里不打算从数学上介绍勒让德变换, 形象地讲这个变换将Lagranage量的一个独立变量
        $\bm{\dot{q}}$替换为了$\bm{p}:=\pdv{L}{\bm{\dot{q}}}$, 这个变换的存在性与动能项的正定性有关. }
        , 定义哈密顿量为$H = p_i \dot q_i - L$. 
        由这个定义可以得出:
        \begin{equation}
            \mathrm{d} H = \dot q_i \mathrm{d} p_i - \dot p_i \mathrm{d} q_i - \frac{\partial L}{\partial t} \mathrm{d} t
        \end{equation}
        与哈密顿量的全微分进行比较, 可以得出:
        \begin{equation}
            \dot{q_{i}} = \pdv{H}{p_i};
            \qquad
            \dot{p_{i}} = -\pdv{H}{q_i}
        \end{equation}
        即哈密顿正则方程.

        \section{Hamilton-Jacobi方程}
        我们有了作用量$S$这个新物理量, 由于最小作用量原理的存在（这意味着这里我们只考虑经典轨迹
        的作用量）, $S$只能是初始时刻、位置和结束时刻、位置的函数, 即:
        \begin{equation}
            S_{cl} = S(\bm{p}_0, t_0; \bm{p}_1, t_1)
        \end{equation}
        可以研究一下其对广义坐标$\bm q$的偏导、
        对时间$t$的偏导与全导. 这里的偏导数比较多, 注意弄清楚每个偏导中那些变量是不变的
        . 

        考虑对于广义坐标的$q$的偏导, 这里实际上考虑的是对初始位置$\bm q^{(1)}$与结束为止$\bm q^{(2)}$的偏导, 并且假设联结这两个点的轨迹是经典的真实运动轨迹. 通过式\ref{eq:8-1-1}, 第一项中的$\delta q_i$就相当于微元, 第二项积分为0. 可以得到
        \begin{equation}
            \left( \frac{\partial S}{\partial q_i^{(1)}} \right)_{t, q_i^{(2)}} = - \frac{\partial L}{\partial \dot q_i};
            \qquad
            \left(\frac{\partial S}{\partial q_i^{(2)}}\right)_{t, q_i^{(1)}} = \frac{\partial L}{\partial \dot q_i}
        \end{equation}
        一般选取末端点的偏导, 并且注意到拉格朗日量对广义速度的偏导数就是广义动量. 因此在不引起歧义时一般写为
        \begin{equation}
            \frac{\partial S}{\partial q_i} = p_i
        \end{equation}

        实际上作用量$S$形式上是一个变上限定积分, 因此全导非常容易得到
        \begin{equation}
            S[\bm q(t)] = \int_{0}^{t} L( \bm q(\tau), \dot{\bm q}(\tau), \tau ) \dd \tau
            \qquad \implies \frac{\mathrm{d} S}{\mathrm{d} t} = L
        \end{equation}
        考虑到全导与偏导的关系, 有
        \begin{equation}
            \frac{\mathrm{d} S}{\mathrm{d} t} = \frac{\partial S}{\partial t} + \frac{\partial S}{\partial q_i} \dot{q}_i = \frac{\partial S}{\partial t} + p_i\dot{q}_i
        \end{equation}
        那么根据哈密顿量的定义$H = p_i \dot q_i - L$, 可以看出
        \begin{equation}\label{eq:8-1-2-1}
            \frac{\partial S}{\partial t} = - H
        \end{equation}

        基于上面的结论, 我们发现只使用作用量$S$及其偏导也可以表述经典力学
        \begin{equation}
            \frac{\partial S}{\partial t} + H(\bm q, \frac{\partial S}{\partial \bm q}, t) = 0
        \end{equation}
        进一步展开可以写为
        \begin{equation}\label{eq:8-1-2-2}
            \frac{\partial S}{\partial t} + \frac{M^{-1}_{ij}(\bm q)}{2} \frac{\partial S}{\partial q_i}\frac{\partial S}{\partial q_j} + V(\bm q, t) = 0
        \end{equation}
        $M^{-1}_{ij}$是质量矩阵的逆. 

        以上\ref{eq:8-1-2-1}至\ref{eq:8-1-2-2}三个方程都可以被称为Hamilton-Jacobi方程. 它提供了一种只使用作用量$S$的偏导数表达经典力学体系的运动规律的方法.

    \section{量子力学的路径积分形式}

        \subsection{传播子与路径积分}

        在前文中, 已经通过含时薛定谔方程得到了时间演化算符. 当不同时刻的哈密顿算符对易且不显含时间时
        \begin{equation}
            | \psi(t) \rangle = \mathrm{e}^{-\frac {\mathrm{i}\hat{H}t}{\hslash}} | \psi(0) \rangle
        \end{equation}
        插入位置本征态
        \begin{equation}
            \langle x | \psi(t) \rangle = \int \mathrm{d} y \langle x | \mathrm{e}^{-\frac {\mathrm{i}\hat{H}t}{\hslash}} | y \rangle  \langle y | \psi(0) \rangle
        \end{equation}
        可以看到，$\langle x | \exp[-\mathrm{i}\hat{H}t / \hslash] | y \rangle$具有状态转移概率的物理含义。
        因此，将其定义为\textbf{传播子}。如果求出传播子, 那么就可以求解含时Schrodinger方程.

        首先研究$\mathrm{e}^{\lambda \hat{A}}\mathrm{e}^{\lambda \hat{B}}$和$\mathrm{e}^{\lambda (\hat{A}+\hat{B})}$的关系. 根据Baker–Campbell–Hausdorff公式, 应有
        \begin{equation}
            \mathrm{e}^{\lambda \hat{A}} \mathrm{e}^{\lambda \hat{B}} = \mathrm{e}^{\lambda (\hat{A}+\hat{B}) + \frac 12 \lambda^2 [\hat{A},\hat{B}] + O(\lambda^2)}
        \end{equation}
        如果$\lambda \to 0$, 可以忽略二阶无穷小量, 则有
        \begin{equation}
            \mathrm{e}^{\lambda \hat{A}} \mathrm{e}^{\lambda \hat{B}} = \mathrm{e}^{\lambda (\hat{A}+\hat{B})}
        \end{equation}
        将时间平均分为$N$份, 令$\lambda = \frac tN$, 并令$N \to \infty$. 所以
        \begin{equation}
            \mathrm{e}^{-\frac {\mathrm{i}\hat{H}t}{N\hslash}} = \mathrm{e}^{-\frac {\mathrm{i}\hat{K}t}{N\hslash}} \mathrm{e}^{-\frac {\mathrm{i}\hat{V}t}{N\hslash}}
        \end{equation}
        代入传播子, 得到
        \begin{equation}\begin{aligned}
            \langle x | \mathrm{e}^{-\frac {\mathrm{i}\hat{H}t}{N\hslash}} | y \rangle &= \langle x | \mathrm{e}^{-\frac {\mathrm{i}t}{N\hslash}\frac {\hat{p}^2}{2m}} 
            \mathrm{e}^{-\frac {\mathrm{i}t}{N\hslash}\hat{V}} |y \rangle\\
            &= \langle x | \mathrm{e}^{- \frac{\mathrm{i}t}{N\hslash} \frac{\hat{p}^2}{2m}} |y \rangle \mathrm{e}^{-\frac {\mathrm{i}t}{N\hslash}V(y)} \\
            &= \mathrm{e}^{-\frac {\mathrm{i}t}{N\hslash}V(y)} \int \langle x | \mathrm{e}^{-\frac {\mathrm{i}t}{N\hslash}\frac {\hat{p}^2}{2m}} |p \rangle \langle p |y \rangle \mathrm{d}p \\
            &= \mathrm{e}^{-\frac {\mathrm{i}t}{N\hslash}V(y)} \int \langle x|p \rangle \langle p|y \rangle \mathrm{e}^{-\frac {\mathrm{i}t}{N\hslash}\frac {p^2}{2m}} \mathrm{d}p\\
            &= \frac 1{2\pi \hslash} \mathrm{e}^{-\frac {\mathrm{i}t}{N\hslash}V(y)} \int \mathrm{e}^{\frac {\mathrm{i}(x-y)p}{\hslash}} \mathrm{e}^{-\frac {\mathrm{i}t}{N\hslash}\frac {p^2}{2m}} \mathrm{d} p
        \end{aligned}\end{equation}
        根据Gauss积分
        \begin{equation}
            \int_{-\infty}^{+\infty} \mathrm{e}^{-ax^2+bx} \mathrm{d}x = \sqrt{\frac {\pi}a} \mathrm{e}^{\frac {b^2}{4a}}
        \end{equation}
        由此得到$t/N \to 0$时的传播子为
        \begin{equation}
            \langle x | \mathrm{e}^{-\frac {\mathrm{i}\hat{H}t}{N\hslash}} | y \rangle = \sqrt{\frac {mN}{2\pi\mathrm{i} \hslash t}} \mathrm{e}^{\mathrm{i}\frac {mN(x-y)^2}{2\hslash t}}\mathrm{e}^{-\frac {\mathrm{i}t}{N\hslash} V(y)}
        \end{equation}
        前两项来自于动能算符, 第三项来自于势能算符. 动能算符和势能算符虽然不对易, 但是在$t/N \to 0$时可以得到这个结果. 

        \splitline

        一般情况下的传播子可以通过对无穷短时间的传播子积分得到
        \begin{equation}
            \langle x_0 | \mathrm{e}^{-\frac {\mathrm{i}\hat{H}t}{\hslash}} | x_N \rangle = \left(\frac{mN}{2\pi\mathrm{i}\hslash t}\right)^{N/2} \left(\prod_{n = 1}^{N-1}\int 
            \mathrm{d} x_n \right) \mathrm{e}^{ \frac{\mathrm{i}t}{\hslash N} \sum_{n = 1}^{N} \left[ \frac{m}{2} \left(\frac{x_{n-1} - x_n}{t/N}\right)^2 - V(x_n)\right] }
        \end{equation}
        在$t/N \to 0$的情形下$N(x_{n-1} - x_n)/t = \dot x_n$, 且可将求和号换为积分号. 那么指数上可写为
        \begin{equation}\begin{aligned}
            \frac{\mathrm{i}t}{\hslash N} \sum_{n = 1}^{N} \left[ \frac{m}{2} \left(\frac{x_{n-1} - x_n}{t/N}\right)^2 - V(x_n)\right] 
            &= \frac{\mathrm{i}}{\hslash} \int_0^t \mathrm{d}t \left[ \frac{1}{2} m \dot x^2 - V(x) \right]\\
            &= \frac{\mathrm{i}}{\hslash} \int_0^t \mathrm{d}t L = \frac{\mathrm{i}}{\hslash} S[x(t)]
        \end{aligned}\end{equation}
        作为一种表示方法, 有\cite{费曼量子力学与路径积分}
        \begin{equation}\label{eq:8-2-1}
            \langle x_0 | \mathrm{e}^{-\frac {\mathrm{i}\hat{H}t}{\hslash}} | x_N \rangle 
            = \int_{x_0}^{x_N} \mathcal{D}[x(t)] \mathrm{e}^{ \frac{\mathrm{i}}{\hslash} S[x(t)] }
        \end{equation}
        其中$\mathcal{D}[x(t)]$表示对所有可能的路径进行积分, 同时将归一化因子作为测度包含在内(这个归一化因子应当是与路径无关的). 
        虽然上面似乎给出了归一化因子的一个形式, 但很明显它对于$N \to \infty$不是一个好的定义. 
        实际上不同体系归一化因子并不是一样的, 需要通过实际计算确定. 

        可以发现传播子其实是一种对所有路径的加权平均, 其中所有路径权重的模相等, 但具有与作用量相关的相位. 
        由于作用量的形式与经典作用量一致, 只要能算得出这个积分就能求出传播子. 
        请注意, 这并不意味着$S[x(t)]$的"结果"也会与经典作用量积分的结果$S[\bar x(t)]$一致(用$\bar x(t)$表示经典轨迹), 
        也就是说一般不能算出轨迹的经典作用量直接带入路径积分表达式.

        \subsection{路径积分的准经典近似}

        经典轨迹作用量$S[\bar x(t)]$的表达式相对容易求得, 它反映了经典粒子的运动状态. 
        而在求传播子的时候, 对所有路径求$S[x(t)]$是一件非常困难的事情. 
        如果能直接将传播子表达式中对所有可能的路径积分换成对经典路径的积分, 将会是一个很有用的近似. 
        我们将这个近似称为\textbf{准经典近似}, 用方程表达出来即为下式(式\ref{eq:8-2-1.1}). 
        \begin{equation}\label{eq:8-2-1.1}
            \langle x_i | \mathrm{e}^{-\frac {\mathrm{i}\hat{H}t}{\hslash}} | x_f \rangle \simeq f(t) \mathrm{e}^{ \frac{\mathrm{i}}{\hslash} S[\bar x(t)] } 
        \end{equation}
        问: 准经典近似在什么条件下成立?

        \splitline

        现在我们证明, 对形式如下的拉格朗日量而言, 准经典近似是精确成立的. 
        \begin{equation}\label{eq:8-2-1.2}
            L(x, \dot x, t) = a(t)\dot x^2 + b(t) \dot x x + c(t) x^2 + d(t) \dot x + e(t) x + f(t)
        \end{equation}
        设粒子从点$(x_1, t_1)$运动到$(x_2, t_2)$, 经典轨迹为$\bar x(t)$. 设计一个新变量$y(t) = x(t) - \bar x(t)$, 有$y(t_1) = y(t_2) = 0$. 
        由于$\bar x(t)$是确定的轨迹, 有$\mathcal{D}[x(t)] = \mathcal{D}[y(t)]$. 作用量的积分为
        \begin{equation}
            S[\bar x(t) + y(t)] = S[\bar x(t)] + \int_{t_1}^{t_2} [a(t)\dot y^2 + b(t) \dot y y + c(t) y^2 + \cdots] \mathrm{d}t
        \end{equation}
        其中对$y$或者$\dot y$的一次项放在了省略号里, 这些项积分为0. 传播子可以写为
        \begin{equation}
            \langle x_1 | \mathrm{e}^{-\frac {\mathrm{i}\hat{H}t}{\hslash}} | x_2 \rangle 
            = \mathrm{e}^{ \frac{\mathrm{i}}{\hslash} S[\bar x(t)] } \int_0^0 \mathcal{D}[y(t)] \mathrm{e}^{ 
                \frac{\mathrm{i}}{\hslash} \int_{t_1}^{t_2} [a(t)\dot y^2 + b(t) \dot y y + c(t) y^2] \mathrm{d}t 
                }
        \end{equation}
        现在注意到积分号中的被积函数与经典轨迹$\bar x(t)$无关, 所以其路径积分应当与$x_1$或$x_2$无关; 且轨迹$y(t)$起始并终止于$y=0$, 因此这个路径积分只能是时间的函数. 这意味着传播子可以写为
        \begin{equation}\begin{aligned}
            \langle x_1 | \mathrm{e}^{-\frac {\mathrm{i}\hat{H}t}{\hslash}} | x_2 \rangle = f(t_1, t_2) \mathrm{e}^{ 
                \frac{\mathrm{i}}{\hslash} S[\bar x(t)] 
                } 
        \end{aligned}\end{equation}
        可以看到, 在差一个$t_1$和$t_2$的函数的意义下, 通过准经典近似能准确求得体系的传播子. 
        而一般不管使用的是何种方法, 归一化系数都是通过间接的方法求出来的. 准经典近似非常有用, 只要拉格朗日量具有式\ref{eq:8-2-1.2}的形式, 即使对多粒子体系, 或是拉格朗日量含时的情况, 也能相对容易地算出传播子的具体形式. 

        \subsection{自由粒子的传播子}

        自由粒子体系的势能为0, 所以可以不需要把时间分成$N$份, 而是直接对整个传播子来计算. 把$V=0,N=1$代入上式, 即得到
        \begin{equation}\label{eq:8-2-2}
            \langle x_0 | \mathrm{e}^{-\frac {\mathrm{i}\hat{H}t}{\hslash}} | y_0 \rangle 
            = \sqrt{\frac {m}{2\pi\mathrm{i} \hslash t}} \mathrm{e}^{-\mathrm{i}\frac {m(x_0 - y_0)^2}{2\hslash t}}
        \end{equation}
        如果推广到$F$维体系, 则有
        \begin{equation}
            \langle \bm{x_0} | \mathrm{e}^{-\frac {\mathrm{i}\hat{H}t}{\hslash}} |\bm{y_0} \rangle 
            = \left(\frac {1}{2\pi\mathrm{i} \hslash t} \right)^{\frac F2} |\mb{M}|^{\frac 12} \mathrm{e}^{-\mathrm{i}\frac {(\bm{x_0}-\bm{y_0})^{\mathrm{T}} \mb{M} (\bm{x_0}-\bm{y_0})}{2\hslash t}}
        \end{equation}

        \splitline

        考虑直接通过路径积分得到自由粒子的传播子. 在经典情况下写出自由粒子作用量
        \begin{equation}
            S[x(t)] = \int_0^t \mathcal{L}(x,\dot{x},t') \mathrm{d}t' = \frac 12 \int_0^t m\dot{x}^2 \mathrm{d}t'
        \end{equation}
        Lagrange函数会满足Euler-Lagrange方程. 而对于自由粒子, Lagrange函数不显含坐标, 所以
        \begin{equation}
            \frac {\mathrm{d}}{\mathrm{d}t} (m \dot x) = 0
        \end{equation}
        由此可见, 速度不随时间变化, 且
        \begin{equation}
            \dot{x} = \frac{y_0 - x_0}t
        \end{equation}
        所以, 上述作用量积分的结果为
        \begin{equation}
            S(x_0, y_0) = \frac{m(y_0 - x_0)^2}{2t}
        \end{equation}
        已证得对于自由粒子准经典近似是精确成立的, 利用传播子的准经典近似(式\ref{eq:8-2-1.1})很容易算出传播子的表达式
        \begin{equation}
            \langle x_0 | \mathrm{e}^{-\frac {\mathrm{i}\hat{H}t}{\hslash}} | y_0 \rangle 
            = \int \mathcal{D}[x(t)] \mathrm{e}^{ \frac{\mathrm{i}}{\hslash} S[x(t)] } = C(t) \mathrm{e}^{\frac {\mathrm{i}}{\hslash} \frac{m(y_0 - x_0)^2}{2t}}
        \end{equation}
        其中$C(t)$是归一化因子. 现在希望能把$C(t)$求出, 给定初始条件
        \begin{equation}
            t \to 0,~~~~~\langle x_0|y_0\rangle = \delta(y_0-x_0)
        \end{equation}
        计算出
        \begin{equation}
            \int_{-\infty}^{+\infty} \mathrm{e}^{\frac {\mathrm{i}}{\hslash} \frac {m(y_0 - x_0)^2}{2t}}\mathrm{d}y_0 = \sqrt{\frac {2\pi\mathrm{i}\hslash t}m}
        \end{equation}
        于是
        \begin{equation}\label{eq:8-2-3}
            C(t) = \sqrt{\frac m{2\pi\mathrm{i}\hslash t}}
        \end{equation}
        我们得出了$t \to 0$时的归一化因子. 为了验证在$t \neq 0$ 时归一化系数是正确的, 设传播子为$C(t) D(t) \mathrm{e}^{\frac{\mathrm{i}}{\hslash}S}$, 带回含时薛定谔方程验证, 其中$D(0) = 1$.
        \begin{equation}
            -\mathrm{i}\hslash \frac {\partial}{\partial t} \langle y_0 | \mathrm{e}^{-\frac {\mathrm{i}\hat{H}t}{\hslash}} |x_0 \rangle 
            =  \langle y_0 | \hat{H} \mathrm{e}^{-\frac {\mathrm{i}\hat{H}t}{\hslash}} |x_0 \rangle 
            = -\frac {\hslash^2}{2m} \frac {\partial^2}{\partial y_0^2} \langle y_0 | \mathrm{e}^{-\frac {\mathrm{i}\hat{H}t}{\hslash}} |x_0 \rangle
        \end{equation}
        展开之后可以得到\(D'(t) = 0\), 所以\(D(t)=1\)是一个常数函数. 
        \begin{equation}\begin{aligned}
            \left[i\hslash D'(t) C(t) - \frac{i\hslash}{2t} D(t) C(t) + \frac{m(x_0-y_0)^2}{2t^2} D(t) C(t) \right] \mathrm{e}^{\frac {\mathrm{i}}{\hslash} S} \\
            = \left[- \frac{i\hslash}{2t} D(t) C(t) + \frac{m(x_0-y_0)^2}{2t^2} D(t) C(t)\right] \mathrm{e}^{\frac {\mathrm{i}}{\hslash} S}
        \end{aligned}\end{equation}
        由此可以确定自由粒子的传播子, 结果与式\ref{eq:8-2-2}相吻合. 

        \subsection{其他体系的传播子}

        即使不是自由体系也可以利用式\ref{eq:8-2-1}进行计算, 但能计算出解析形式传播子的体系非常少. 
        目前, 传播子可以写出解析表达式的束缚态有: 自由粒子、无限深方势阱、谐振子、Morse势、类氢原子等\cite{Grosche_HFPI}\cite{Kleinnert_PIQMSPP}. 

        谐振子体系是一个可以求出解析形式传播子的体系, 读者可以尝试计算一下谐振子的传播子作为练习\footnote{用准经典近似很简单, 读者也可以尝试下不用准经典近似怎么做}. 结果为
        \begin{equation}
            \langle x | \mathrm{e}^{-\frac {\mathrm{i}}{\hslash}\hat{H}_\mathrm{HO}t} | y \rangle 
            = \sqrt{\frac{m\omega}{2\mathrm{i}\pi\hslash\sin(\omega t)}} \exp\left\{ \frac{\mathrm{i}}{\hslash} \frac{m\omega}{2\sin(\omega t)}\left[ (x^2 + y^2)\cos(\omega t) - 2xy \right] \right\} \\
        \end{equation}

        有关这方面的内容, 可以参考\cite{费曼量子力学与路径积分}\cite{谷村吉隆化学物理入门}.

    \section{虚时路径积分}

        \subsection{路径积分分子动力学}

        注意到量子体系下的Boltzmann分布为
        \begin{equation}
            \mathrm{e}^{-\beta \hat{H}} = \sum_n \mathrm{e}^{-\beta E_n} |\phi_n \rangle \langle \phi_n|
        \end{equation}
        类似地, 可以作和
        \begin{equation}
            \mathrm{e}^{-\frac {\mathrm{i}\hat{H}t}{\hslash}} = \sum_n \mathrm{e}^{-\frac {\mathrm{i}E_n t}{\hslash}} |\phi_n \rangle \langle \phi_n|
        \end{equation}
        我们发现上述的两个式子有一定的相似性. 两者的区别在于指数上与哈密顿量相乘的标量一个是虚数一个是实数. 
        如果将$\beta$对应成时间$t$, 则可称为\textbf{虚时间}. 对应关系为
        \begin{equation}
            t \leftrightarrow -\mathrm{i}\hslash \beta
        \end{equation}
        显然地, 高温对应虚时间的短时, 低温对应虚时间的长时. 同样可求出虚时间下的传播子
        \begin{equation}
            \langle x|\mathrm{e}^{-\beta \hat{H}}|y\rangle
        \end{equation}
        求出配分函数
        \begin{equation}\begin{aligned}
            Z &= \mathrm{Tr}(\mathrm{e}^{-\beta \hat{H}}) \\
            &= \sum_n \langle n| \mathrm{e}^{-\beta \hat{H}}|n\rangle \\
            &= \int \langle x|\mathrm{e}^{-\beta \hat{H}}|x\rangle \,\mathrm{d}x
        \end{aligned}\end{equation}
        在路径积分的语言下可以放弃态的概念, 也不需要有波函数, 只要有传播子就有配分函数, 有了配分函数就得到了体系所有的热力学性质. 
        要求这个积分中的传播子, 将$\beta$分为$P$份. 在$P \to \infty$时, 有
        \begin{equation}\begin{aligned}
            Z &= \int \mathrm{d} x^{(1)} \cdots \mathrm{d} x^{(P)} \left(\frac{mP}{2\pi \hslash^2 \beta}\right)^{P/2} \\ & \qquad\times\left.
            \exp\left( -\beta \sum_{k=1}^{P} \left[\frac{mP(x^{(k+1)}-x^{(k)})^2}{2\hslash^2 \beta^2}+\frac{1}{P}V(x^{(k)})\right]\right)\right|_{x_1 = x_{P+1}}
        \end{aligned}\end{equation}
        其中$x_1 = x_{P+1}$. 发现动能项的形式类似于一个谐振子, 可以定义$\omega_P = \frac P{\hslash \beta}$. 
        指数上的部分看作$P$个点组成的环两两用弹簧连接, 且每个点都额外受外力作用. 它可以写成一个等效势能$V_\mathrm{eff}$:
        \begin{equation}
            Z = \langle x|\mathrm{e}^{-\beta \hat{H}}|x\rangle = C(\beta) \int \mathrm{e}^{-\beta V_\mathrm{eff}(\bm{x})} \mathrm{d}\bm{x}
        \end{equation}
        这无疑是一个高维积分, 可以通过Monte-Carlo算法计算, 这种做法称为\textbf{路径积分蒙特卡洛(Path integral Monte Carlo, PIMC)}. 
        除此之外也可以在这里插入一个关于“动量”的积分
        \begin{equation}\begin{aligned}
            Z &= \left(\frac{mP}{2\pi \hslash^2 \beta}\right)^{P/2} \left(\frac{\beta}{2\pi m}\right)^{P/2} \left( \prod_{k=1}^{P} \int \mathrm{d} x^{(k)} \mathrm{d} p^{(k)} \right) \\ & \qquad\times\left.
            \exp\left( -\beta \sum_{k=1}^{P} \left[\frac{(p^{(k)})^2}{2m}+\frac{mP(x^{(k+1)}-x^{(k)})^2}{2\hslash^2 \beta^2}+\frac{1}{P}V(x^{(k)})\right]\right)\right|_{x_1 = x_{P+1}} \\
            &= \left( \prod_{k=1}^{P} \int \frac{\mathrm{d} x^{(k)} \mathrm{d} p^{(k)}}{2\pi\hslash}  \right) \mathrm{e}^{-\beta H_\mathrm{cl}}
        \end{aligned}\end{equation}
        这里我们得到了一个有效哈密顿量$H_\mathrm{cl}$, 这个哈密顿量描述一个经典体系. 该体系的动量是人为的、没有意义
        \footnote{这意味你可以任意设定动量项中的质量, 质量矩阵没有必要是对角的, 更没有必要等于$m$. 当然让它等于$m$会让公式显得简洁一些}, 
        但可以通过其位型空间的分布得到对应量子体系的配分函数. 
        \begin{equation}
            H_\mathrm{cl} = \left. \sum_{k=1}^{P} \left[\frac{(p^{(k)})^2}{2m}+\frac{mP(x^{(k+1)}-x^{(k)})^2}{2\hslash^2 \beta^2}+\frac{1}{P}V(x^{(k)})\right] \right|_{x_1 = x_{P+1}}
        \end{equation}

        因此，此时体系满足的运动方程为
        \begin{equation}
            \begin{gathered}
            \dot{x}_{k}=\frac{p_{k}}{m^{\prime}} \\
            \dot{p}_{k}=-m \omega_{p}^{2}\left(2 x_{k}-x_{k+1}-x_{k-1}\right)-\frac{1}{P} \frac{\partial V}{\partial x_{k}}
            \end{gathered}
        \end{equation}

        因此，可以通过分子动力学方法来有效地对其位型空间的分布进行采样\footnote{
            实际上上述方程在应用时会出现难以收敛的问题。需要对坐标进行staging transform以进行运动的解耦合。
            详见Tuckerman 第4章、第12章。
        }, 这种方法称为
        \textbf{路径积分分子动力学(Path Integral Molecular Dynamics, PIMD)}. 
        如果$P=1$, 上式得到的结果就是经典统计力学的结果, 这体现了量子力学与经典统计力学的同构.

        特别的, 如果一个算符$\hat{A} = A(\hat x)$只是位置的函数, 那么
        \begin{equation}\begin{aligned}
            \langle {\hat A} \rangle = \left( \prod_{k=1}^{P} \int \frac{\mathrm{d} x^{(k)} \mathrm{d} p^{(k)}}{2\pi\hslash}  \right)  \left[ \frac1P\sum_{k=1}^{P}A(x^{(k)}) \right] \mathrm{e}^{-\beta H_\mathrm{cl}}
        \end{aligned}\end{equation}
        上式实际上就是$H_\mathrm{cl}$描述的经典体系中$A(x)$平均值的系综平均.

        \subsection{量子Monte-Carlo}

        考虑含时Schodinger方程：
        \begin{equation}
            \mathrm{i}\hslash \frac {\partial}{\partial t} | \psi(t) \rangle = \hat{H}|\psi(t) \rangle
        \end{equation}
        将其改写为关于$\beta$的方程：
        \begin{equation}
            -\frac {\partial}{\partial \beta} |\psi(\beta) \rangle = \hat{H} |\psi(\beta) \rangle
        \end{equation}

        任意给定一个初态, 可以写成Hamilton函数的本征函数的线性组合
        \begin{equation}
            |\psi(0) \rangle = \sum_n c_n |\phi_n\rangle
        \end{equation}
        并且
        \begin{equation}
            |\psi(\beta) \rangle = \mathrm{e}^{-\beta \hat{H}} |\psi(0) \rangle = \sum_n c_n\mathrm{e}^{-\beta E_n}|\phi_n \rangle 
            = \mathrm{e}^{-\beta E_0} \sum_n c_n \mathrm{e}^{-\beta(E_n-E_0)} |\phi_n \rangle
        \end{equation}
        因此, 当$\beta \to \infty$时, 得到的就是基态$|\phi_0 \rangle$. 基于此开发出了\textbf{量子蒙特卡罗(Quantum Monte Carlo, QMC)}算法
        \footnote{QMC实际上是一系列量子力学和随机数方法结合产生的算法, 这里提到的算法应该叫做扩散蒙特卡罗(Diffusion Monte Carlo, DMC)算法}. 
        如果想求第一激发态, 只需要设计投影算符$\hat P = \hat I - |\phi_0 \rangle\langle \phi_0|$在迭代过程中不断将基态除去, 迭代就会收敛到第一激发态上. 

    \bibliographystyle{plain}
    \bibliography{ref_lagrange}